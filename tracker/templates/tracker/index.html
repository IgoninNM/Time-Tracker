<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Time Tracker</title>
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'tracker/tracker.css' %}">
    <form id="logout" method="post" action="{% url 'tracker:results' user %}">
        {% csrf_token %}
        <button type="submit" name="action" value="previous" style="float:right">Logout</button>
    </form>
</head>
<body>
     <h2 id="header">Welcome {{ user }}</h2>
     {% if messages %}
     <ul class="messages">
         {% for message in messages %}
         <li class="{{ message.tags }}" >{{ message }}</li>
         {% endfor %}
     </ul>
     {% endif %}

     <datalist id="code_options">
        <option value="Sick Time">1</option>
        <option value="Vacation Time">2</option>
        <option value="Administration Tasks">3</option>
    </datalist>

     <div class="tab">
         <button class="tablinks" id="defaultOpen" onclick="openTab(event, 'form1')">Time Form</button>
         <button class="tablinks" onclick="openTab(event, 'task_list')">Performed Tasks</button>
         <button class="tablinks" onclick="openTab(event, 'work_codes')">Work Codes</button>
         <button class="tablinks" onclick="openTab(event, 'my_info')">My Info</button>
     </div>

     <div id="form1" class="tabcontent">
            <form action="{% url 'tracker:results' user %}" method="post" id="time_form">
                {% csrf_token %}
                <br>
                <label>Work Code:</label> <input list="code_options" name="code" required autocomplete="off"><br><br>
                <label>Work Description:</label> <textarea name="task" required autocomplete="off"></textarea><br><br>
                <br>
                Hours: <input type="number" name="hours" value="0" max="9"><br><br>
                Minutes: <input type="number" name="minutes" value="0" max="59"><br><br>
                    OR
                <br>
                <br>
                Time Start: <input type="time" name="start"><br><br>
                Time End: <input type="time" name="end"><br>
                <br>
                <button id="submit" type="submit" name="action" value="submission">Submit</button>
                <br>
                <br>
            </form><br>
     </div>

     <div id="task_list" class="tabcontent">
        <div id="tasks">
            <h2>You've Been Working On:</h2>
            <ul>
                {% for entry in user_obj.task_set.all %}
                    <li><a href="{% url 'tracker:tasks' user entry.task_code %}">{{ entry.task_code }}</a></li>
                {% endfor %}
            </ul>
        </div>
     </div>

     <div id="my_info" class="tabcontent">
         <h2> Username: {{ user_obj.username_text }}</h2>
         <h2>First Name: {{ user_obj.first_name }}</h2>    <h2>Last Name: {{ user_obj.last_name }}</h2>
         <h2>Department: {{ user_obj.department }}</h2>
         <h2>Role: {{ user_obj.role }}</h2>
     </div>

     <div id="work_codes" class="tabcontent">
         <div>
             <ul id="code_list"></ul>
             <script>
                 var div = document.getElementById("code_list");
                 for(i=0; i < document.getElementById("code_options").options.length; i++){
                     var lst = document.createElement("LI");
                     var t = document.createTextNode(document.getElementById("code_options").options[i].value)
                     lst.appendChild(t);
                     div.appendChild(lst);
                 };
             </script>
         </div>
     </div>
     <script>
         function openTab(evt, cityName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(cityName).style.display = "block";
            evt.currentTarget.className += " active";
        }
        document.getElementById("defaultOpen").click();
     </script>
</body>
</html>
